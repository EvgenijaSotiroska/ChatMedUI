create table users
(
    username   varchar(255) primary key,
    password   varchar(255),
    first_name varchar(255),
    last_name  varchar(255)
);

create table tasks
(
    id              bigint generated by default as identity primary key,
    name            varchar(255),
    assigned_to     varchar(255) references users not null,
    due_date        date,
    ongoing_tasks   varchar(255),
    task_priority   varchar(255)
);

create table domains (
                         id bigint generated by default as identity primary key,
                         domain_id VARCHAR(255) NOT NULL,
                         domain_text VARCHAR(255) NOT NULL
);

create table fields (
                        id bigint generated by default as identity primary key,
                        field_id varchar(255) not null,
                        field_text varchar(255) not null
);

create table models (
                        id bigint generated by default as identity primary key,
                        model_name varchar(255) not null,
                        release_date date
);

create table questions (
                           id bigserial primary key,
                           field_id bigint,
                           domain_id bigint,

                           constraint fk_questions_field foreign key (field_id) references fields(id),
                           constraint fk_questions_domain foreign key (domain_id) references domains(id)
);

create table evaluations (
                             id bigint generated by default as identity primary key,
                             question_id BIGINT,
                             model_id BIGINT,
                             user_username VARCHAR(255),
                             comment TEXT,
                             accuracy DOUBLE PRECISION,
                             comprehensiveness DOUBLE PRECISION ,
                             clarity DOUBLE PRECISION ,
                             empathy DOUBLE PRECISION ,
                             bias INT,
                             harm INT,
                             relevance DOUBLE PRECISION ,
                             currency DOUBLE PRECISION ,
                             understanding DOUBLE PRECISION,
                             reasoning DOUBLE PRECISION ,
                             factuality_verification DOUBLE PRECISION ,
                             fabrication INT,
                             falsification INT,
                             plagiarism INT,

                             CONSTRAINT fk_question FOREIGN KEY (question_id) REFERENCES questions(id),
                             CONSTRAINT fk_model FOREIGN KEY (model_id) REFERENCES models(id),
                             CONSTRAINT fk_user FOREIGN KEY (user_username) REFERENCES users(username)
);

create table workspaces
(
    id          bigint generated by default as identity primary key,
    name        varchar(255),
    description varchar(4000)
);

create table workspace_tasks
(
    workspace_id bigint references workspaces on delete cascade,
    task_id      bigint references tasks on delete cascade,
    primary key (workspace_id, task_id)
);

create table workspace_users
(
    workspace_id bigint references workspaces on delete cascade,
    user_username varchar(255) references users on delete cascade,
    primary key (workspace_id, user_username)
);

CREATE TABLE workspace_models (
                                  workspace_id bigint references workspaces on delete cascade,
                                  model_id bigint references models on delete cascade,
                                  primary key (workspace_id, model_id)
);

CREATE TABLE workspace_questions (
                                     workspace_id bigint references workspaces on delete cascade,
                                     question_id bigint references questions on delete cascade,
                                     primary key (workspace_id, question_id)
);

INSERT INTO domains (domain_id, domain_text) VALUES
                                                 ('D1', 'Clinical evaluation'),
                                                 ('D2', 'EEG'),
                                                 ('D3', 'Neuroimaging'),
                                                 ('D4', 'Neuropsychological');

insert into fields (field_id, field_text) values
                                              ('F1', 'Diagnostic evaluation'),
                                              ('F2', 'Treatment'),
                                              ('F3', 'Clinical aspects'),
                                              ('F4', 'Special situations');

insert into models (model_name, release_date) values
                                                  ('ChatGPT-4', '2023-03-14'),
                                                  ('Gemini-1.5', '2024-02-01'),
                                                  ('LLaMA-3', '2024-04-15');

insert into users (username, password, first_name, last_name) values
                                                                  ('angela', '$2a$10$luFwkj5YL0nuT0GzUpntM.OS.S2md67ZuGmQ/2de3vrowxVbDzNf6', 'Angela', 'Angeleska'),
                                                                  ('evgenija', '$2a$10$hqQysK1/R5LGV7oVQP0INOaSoyWTUNy5cPs4Biq9lcWCvxSccqlHu', 'Evgenija', 'Sotiroska');

INSERT INTO tasks (name, assigned_to, ongoing_tasks, task_priority, due_date)
VALUES
    ('Clinical EEG Review', 'angela', 'Ongoing', 'High', '2025-07-01'),
    ('Neuroimaging Analysis', 'angela', 'Not Started', 'Medium', '2025-07-02'),
    ('Research Paper Draft', 'evgenija', 'Completed', 'Low', '2025-07-03');

INSERT INTO workspaces (name, description) VALUES
                                               ('Clinical Evaluation Workspace', 'Workspace for clinical EEG and neuroimaging evaluations'),
                                               ('Research Workspace', 'Workspace for neuropsychological research projects');

INSERT INTO workspace_tasks (workspace_id, task_id) VALUES
                                                        (1, (SELECT id FROM tasks WHERE name = 'Clinical EEG Review')),
                                                        (1, (SELECT id FROM tasks WHERE name = 'Neuroimaging Analysis')),
                                                        (2, (SELECT id FROM tasks WHERE name = 'Research Paper Draft'));

INSERT INTO workspace_users (workspace_id, user_username) VALUES
                                                              (1, 'angela'),
                                                              (1, 'evgenija'),
                                                              (2, 'angela');

INSERT INTO workspace_models (workspace_id, model_id) VALUES
                                                          (1, (SELECT id FROM models WHERE model_name = 'ChatGPT-4')),
                                                          (1, (SELECT id FROM models WHERE model_name = 'Gemini-1.5')),
                                                          (2, (SELECT id FROM models WHERE model_name = 'LLaMA-3'));

INSERT INTO questions (field_id, domain_id) VALUES
                                                (1, 1), (1, 2), (2, 3), (3, 4), (4, 1);

INSERT INTO workspace_questions (workspace_id, question_id) VALUES
                                                                (1, 1), (1, 2), (1, 3),
                                                                (2, 4), (2, 5);

INSERT INTO evaluations (
    question_id, model_id, user_username, comment,
    accuracy, comprehensiveness, clarity, empathy,
    bias, harm, relevance, currency,
    understanding, reasoning, factuality_verification,
    fabrication, falsification, plagiarism
) VALUES
      (1, 1, 'angela', 'Accurate but slightly verbose', 4.8, 4.5, 4.7, 3.9, 0, 0, 4.9, 4.2, 4.6, 4.8, 4.5, 0, 0, 0),
      (2, 1, 'evgenija', 'Excellent clinical context', 4.9, 4.7, 4.8, 4.5, 0, 0, 4.8, 4.3, 4.7, 4.9, 4.6, 0, 0, 0),
      (3, 1, 'angela', 'Minor factual inaccuracies', 3.8, 4.2, 4.0, 3.5, 1, 0, 4.1, 3.9, 4.0, 3.8, 3.7, 1, 0, 0),

      (1, 2, 'evgenija', 'Concise and relevant', 4.6, 4.8, 4.9, 4.2, 0, 0, 4.7, 4.5, 4.8, 4.7, 4.6, 0, 0, 0),
      (4, 2, 'angela', 'Lacks depth in special situations', 3.9, 3.7, 4.1, 3.8, 0, 1, 3.8, 4.0, 3.9, 3.7, 3.8, 0, 0, 1),
      (5, 2, 'evgenija', 'Good treatment analysis', 4.5, 4.3, 4.4, 4.1, 0, 0, 4.6, 4.2, 4.5, 4.3, 4.4, 0, 0, 0),

      (3, 3, 'angela', 'Strong neuroimaging insights', 4.7, 4.6, 4.5, 4.3, 0, 0, 4.8, 4.4, 4.7, 4.6, 4.5, 0, 0, 0),
      (4, 3, 'evgenija', 'Outdated clinical references', 3.5, 3.8, 4.0, 3.2, 0, 0, 3.6, 2.8, 3.7, 3.5, 3.6, 0, 1, 0),
      (5, 3, 'angela', 'Excellent diagnostic evaluation', 4.9, 4.8, 4.7, 4.6, 0, 0, 4.9, 4.7, 4.8, 4.9, 4.7, 0, 0, 0);
